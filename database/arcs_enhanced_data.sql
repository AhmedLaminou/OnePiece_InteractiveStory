-- =====================================================
-- ONE PIECE ARCS ENHANCED DATA
-- Comprehensive arc data with full descriptions, images, and statistics
-- =====================================================

USE onepiece_complete;

-- Update arcs with enhanced descriptions and image URLs
UPDATE arcs SET description = 'The beginning of Luffy''s journey! After eating the Gomu Gomu no Mi, young Luffy was inspired by the pirate Shanks to become the King of the Pirates. Ten years later, he sets sail from Foosha Village to gather a crew and find the legendary One Piece treasure.', image_url = 'https://onepiece.fandom.com/wiki/Romance_Dawn_Arc' WHERE id = 'arc_romance_dawn';

UPDATE arcs SET description = 'Luffy and Zoro arrive at Orange Town, terrorized by the Buggy Pirates. They meet Nami, a skilled thief and navigator who despises pirates. Together, they defeat Buggy and free the town from his tyranny. This arc introduces Buggy''s Chop-Chop Devil Fruit powers.', image_url = 'https://onepiece.fandom.com/wiki/Orange_Town_Arc' WHERE id = 'arc_orange_town';

UPDATE arcs SET description = 'The crew arrives at Syrup Village where they meet Usopp, the village liar with dreams of becoming a brave warrior of the sea. They uncover Captain Kuro''s plot to assassinate the wealthy Kaya and must defend the village from the Black Cat Pirates. Usopp joins the crew and they receive the Going Merry.', image_url = 'https://onepiece.fandom.com/wiki/Syrup_Village_Arc' WHERE id = 'arc_syrup_village';

UPDATE arcs SET description = 'At the floating restaurant Baratie, the crew meets Sanji, a chef with a dream to find the legendary All Blue. The arrival of Don Krieg''s armada and the World''s Greatest Swordsman Dracule Mihawk leads to intense battles. Zoro suffers his first defeat but gains resolve, and Sanji joins the crew.', image_url = 'https://onepiece.fandom.com/wiki/Baratie_Arc' WHERE id = 'arc_baratie';

UPDATE arcs SET description = 'One of the most emotional arcs in One Piece. Nami''s tragic past is revealed - her village enslaved by the fish-man Arlong, her mother Bellemere''s sacrifice, and her deal to buy back her village''s freedom. When that deal is betrayed, Luffy destroys Arlong Park and declares "Nami is my friend!"', image_url = 'https://onepiece.fandom.com/wiki/Arlong_Park_Arc' WHERE id = 'arc_arlong_park';

UPDATE arcs SET description = 'The crew visits Loguetown, the town where the Pirate King Gol D. Roger was born and executed. Luffy is nearly executed on the same platform but is saved by a mysterious lightning strike. Captain Smoker is introduced, and Luffy''s father Dragon makes his first appearance.', image_url = 'https://onepiece.fandom.com/wiki/Loguetown_Arc' WHERE id = 'arc_loguetown';

UPDATE arcs SET description = 'The crew enters the Grand Line through Reverse Mountain and meets Laboon, a whale who has waited 50 years for his pirate friends. Luffy makes a promise to return and fight Laboon properly. This arc sets up the connection to Brook and the Rumbar Pirates.', image_url = 'https://onepiece.fandom.com/wiki/Reverse_Mountain_Arc' WHERE id = 'arc_reverse_mountain';

UPDATE arcs SET description = 'At Whisky Peak, the crew is welcomed by bounty hunters working for the criminal organization Baroque Works. Zoro single-handedly defeats 100 of them. Princess Vivi of Arabasta is revealed to be infiltrating Baroque Works to save her kingdom from the mysterious Mr. 0.', image_url = 'https://onepiece.fandom.com/wiki/Whisky_Peak_Arc' WHERE id = 'arc_whisky_peak';

UPDATE arcs SET description = 'A prehistoric island where giants Dorry and Brogy have been fighting for over 100 years. The crew learns the importance of honor and pride among warriors. Mr. 3''s wax powers nearly kill the crew before they escape.', image_url = 'https://onepiece.fandom.com/wiki/Little_Garden_Arc' WHERE id = 'arc_little_garden';

UPDATE arcs SET description = 'Nami falls critically ill, forcing the crew to find a doctor on the winter island of Drum. They meet Dr. Kureha and Tony Tony Chopper, a reindeer who ate the Human-Human Fruit. Chopper''s heartbreaking backstory with Dr. Hiluluk and the miraculous cherry blossoms make this an unforgettable arc.', image_url = 'https://onepiece.fandom.com/wiki/Drum_Island_Arc' WHERE id = 'arc_drum_island';

UPDATE arcs SET description = 'The desert kingdom of Arabasta is on the brink of civil war, orchestrated by Crocodile, one of the Seven Warlords. The Straw Hats fight to save Vivi''s homeland in an epic battle against Baroque Works. Luffy defeats Crocodile after three intense fights, and the rain finally falls on Arabasta.', image_url = 'https://onepiece.fandom.com/wiki/Arabasta_Arc' WHERE id = 'arc_arabasta';

UPDATE arcs SET description = 'The crew searches for the legendary Sky Island, meeting the Bellamy Pirates who mock their dreams. Blackbeard makes his first significant appearance. The crew rides the Knock Up Stream to reach Skypiea.', image_url = 'https://onepiece.fandom.com/wiki/Jaya_Arc' WHERE id = 'arc_jaya';

UPDATE arcs SET description = 'An adventure in the sky! The crew discovers the lost city of Shandora and the golden bell. They battle Enel, a self-proclaimed god with lightning powers. Luffy''s rubber body proves to be the perfect counter. The 400-year-old promise between Montblanc Noland and the Shandia is finally fulfilled.', image_url = 'https://onepiece.fandom.com/wiki/Skypiea_Arc' WHERE id = 'arc_skypiea';

UPDATE arcs SET description = 'The crew participates in the Davy Back Fight against Foxy Pirates. More importantly, they encounter Admiral Aokiji, who reveals the darkness of Robin''s past and the government''s interest in her.', image_url = 'https://onepiece.fandom.com/wiki/Long_Ring_Long_Land_Arc' WHERE id = 'arc_long_ring_long_land';

UPDATE arcs SET description = 'The shipwright paradise of Water 7 brings tragedy - the Going Merry can no longer sail, and Robin seemingly betrays the crew. The mystery of CP9 and Robin''s connection to the World Government unfolds. Franky is introduced, and the crew faces their greatest internal crisis.', image_url = 'https://onepiece.fandom.com/wiki/Water_7_Arc' WHERE id = 'arc_water_7';

UPDATE arcs SET description = 'The Straw Hats declare war on the World Government to save Robin! Storming the judicial island of Enies Lobby, each crew member faces an elite CP9 agent. Luffy unleashes Gear Second and Third. Robin finally accepts her will to live, and the crew burns the World Government flag.', image_url = 'https://onepiece.fandom.com/wiki/Enies_Lobby_Arc' WHERE id = 'arc_enies_lobby';

UPDATE arcs SET description = 'The aftermath of Enies Lobby. The Thousand Sunny is built by Franky, who officially joins the crew. The Going Merry receives a Viking funeral. Luffy''s grandfather Garp visits, revealing that Luffy''s father is Dragon, the Revolutionary.', image_url = 'https://onepiece.fandom.com/wiki/Post-Enies_Lobby_Arc' WHERE id = 'arc_post_enies_lobby';

UPDATE arcs SET description = 'A haunted ship, zombies, and a skeleton musician! The crew boards Thriller Bark, Gecko Moria''s massive ship. They meet Brook, a living skeleton who ate the Revive-Revive Fruit. The battle against Oars and Moria pushes the crew to their limits, and Zoro takes all of Luffy''s pain from Kuma.', image_url = 'https://onepiece.fandom.com/wiki/Thriller_Bark_Arc' WHERE id = 'arc_thriller_bark';

UPDATE arcs SET description = 'The crew reaches the Sabaody Archipelago, gateway to the New World. All eleven Supernovas gather here. The crew witnesses the cruelty of the World Nobles and attacks one. Admiral Kizaru arrives, and Kuma scatters the crew across the world - their greatest defeat.', image_url = 'https://onepiece.fandom.com/wiki/Sabaody_Archipelago_Arc' WHERE id = 'arc_sabaody_archipelago';

UPDATE arcs SET description = 'Luffy lands on the island of women, Amazon Lily. He meets Boa Hancock, the Pirate Empress and one of the Seven Warlords. Learning that his brother Ace is to be executed, Luffy embarks on a desperate rescue mission to Impel Down.', image_url = 'https://onepiece.fandom.com/wiki/Amazon_Lily_Arc' WHERE id = 'arc_amazon_lily';

UPDATE arcs SET description = 'The underwater prison break! Luffy infiltrates Impel Down to save Ace, encountering old enemies and making new allies including Emporio Ivankov and Jinbe. He battles Magellan''s poison and breaks out with hundreds of prisoners, but arrives too late.', image_url = 'https://onepiece.fandom.com/wiki/Impel_Down_Arc' WHERE id = 'arc_impel_down';

UPDATE arcs SET description = 'The War of the Best - the greatest battle in One Piece history. Whitebeard''s pirates assault Marineford to save Ace. Legends clash as the Admirals, Warlords, and Emperors fight. Ace is freed but dies protecting Luffy. Whitebeard falls. Shanks ends the war. The world is forever changed.', image_url = 'https://onepiece.fandom.com/wiki/Marineford_Arc' WHERE id = 'arc_marineford';

UPDATE arcs SET description = 'The aftermath of Marineford. Luffy, devastated by Ace''s death, must find his will to continue. With Jinbe and Rayleigh''s help, he sends a message to his scattered crew: meet in two years. The timeskip begins as each Straw Hat trains to become stronger.', image_url = 'https://onepiece.fandom.com/wiki/Post-War_Arc' WHERE id = 'arc_post_war';

UPDATE arcs SET description = 'Two years later! The Straw Hats reunite at Sabaody, each having grown tremendously. They easily defeat imposters and the Marines who underestimated them. The crew descends to Fish-Man Island.', image_url = 'https://onepiece.fandom.com/wiki/Return_to_Sabaody_Arc' WHERE id = 'arc_return_to_sabaody';

UPDATE arcs SET description = 'The underwater paradise and home of the fish-men and merfolk. The crew meets Jinbe officially and confronts the New Fish-Man Pirates led by Hody Jones. Luffy declares Fish-Man Island his territory and defeats Hody. Princess Shirahoshi is revealed as the ancient weapon Poseidon.', image_url = 'https://onepiece.fandom.com/wiki/Fish-Man_Island_Arc' WHERE id = 'arc_fish_man_island';

UPDATE arcs SET description = 'The burning and freezing island where Caesar Clown conducts cruel experiments. Luffy and Law form an alliance to take down the Four Emperors, starting with Kaido. They capture Caesar, setting up the events of Dressrosa.', image_url = 'https://onepiece.fandom.com/wiki/Punk_Hazard_Arc' WHERE id = 'arc_punk_hazard';

UPDATE arcs SET description = 'The longest arc in One Piece! The alliance takes on Doflamingo in the kingdom of Dressrosa. Sabo returns alive and inherits Ace''s Flame-Flame Fruit. Luffy awakens Gear Fourth and defeats Doflamingo. The Straw Hat Grand Fleet is formed with 5,600 members.', image_url = 'https://onepiece.fandom.com/wiki/Dressrosa_Arc' WHERE id = 'arc_dressrosa';

UPDATE arcs SET description = 'The living elephant island of Zou is home to the Mink Tribe. The crew learns about the Road Poneglyphs, the key to reaching Laugh Tale. The Ninja-Pirate-Mink-Samurai Alliance is formed to liberate Wano and defeat Kaido.', image_url = 'https://onepiece.fandom.com/wiki/Zou_Arc' WHERE id = 'arc_zou';

UPDATE arcs SET description = 'Big Mom''s territory! The crew infiltrates Whole Cake Island to rescue Sanji from his arranged marriage to the Charlotte Family. Sanji''s tragic past is revealed. Luffy defeats Katakuri after an incredible battle and develops future sight. Jinbe officially joins the crew.', image_url = 'https://onepiece.fandom.com/wiki/Whole_Cake_Island_Arc' WHERE id = 'arc_whole_cake_island';

UPDATE arcs SET description = 'The world leaders gather at Mary Geoise for the Reverie. Major events unfold including the dissolution of the Seven Warlords system, Sabo''s alleged assassination of King Cobra, and hints about the mysterious Im.', image_url = 'https://onepiece.fandom.com/wiki/Levely_Arc' WHERE id = 'arc_reverie';

UPDATE arcs SET description = 'The land of samurai and the greatest arc yet! The alliance battles the Beast Pirates and Big Mom Pirates in Onigashima. Luffy awakens his true Devil Fruit power - the Mythical Zoan Hito Hito no Mi, Model: Nika. He defeats Kaido and becomes one of the Four Emperors.', image_url = 'https://onepiece.fandom.com/wiki/Wano_Country_Arc' WHERE id = 'arc_wano_country';

UPDATE arcs SET description = 'The Final Saga begins! The crew arrives at Egghead, home of the genius scientist Dr. Vegapunk. Secrets of the Void Century, the Ancient Kingdom, and the true enemy are revealed. The Five Elders descend, and the mystery of Joy Boy deepens.', image_url = 'https://onepiece.fandom.com/wiki/Egghead_Arc' WHERE id = 'arc_egghead';

-- =====================================================
-- USER INTERACTION TABLES
-- Ratings, Likes, and Progress Tracking
-- =====================================================

-- Table for chapter ratings and likes
CREATE TABLE IF NOT EXISTS chapter_ratings (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id VARCHAR(100) NOT NULL,
    chapter_number INT NOT NULL,
    rating INT CHECK (rating >= 1 AND rating <= 5),
    is_liked BOOLEAN DEFAULT FALSE,
    is_disliked BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY unique_user_chapter (user_id, chapter_number),
    FOREIGN KEY (chapter_number) REFERENCES chapters(chapter_number) ON DELETE CASCADE
);

-- Table for episode ratings and likes
CREATE TABLE IF NOT EXISTS episode_ratings (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id VARCHAR(100) NOT NULL,
    episode_number INT NOT NULL,
    rating INT CHECK (rating >= 1 AND rating <= 5),
    is_liked BOOLEAN DEFAULT FALSE,
    is_disliked BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY unique_user_episode (user_id, episode_number),
    FOREIGN KEY (episode_number) REFERENCES episodes(episode_number) ON DELETE CASCADE
);

-- Table for arc ratings
CREATE TABLE IF NOT EXISTS arc_ratings (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id VARCHAR(100) NOT NULL,
    arc_id VARCHAR(50) NOT NULL,
    rating INT CHECK (rating >= 1 AND rating <= 5),
    is_liked BOOLEAN DEFAULT FALSE,
    review TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY unique_user_arc (user_id, arc_id),
    FOREIGN KEY (arc_id) REFERENCES arcs(id) ON DELETE CASCADE
);

-- Table for user reading progress
CREATE TABLE IF NOT EXISTS user_reading_progress (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id VARCHAR(100) NOT NULL,
    arc_id VARCHAR(50),
    chapter_number INT,
    episode_number INT,
    progress_percentage INT DEFAULT 0,
    last_read_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE KEY unique_user_progress (user_id, arc_id)
);

-- Indexes for performance
CREATE INDEX idx_chapter_ratings_user ON chapter_ratings(user_id);
CREATE INDEX idx_episode_ratings_user ON episode_ratings(user_id);
CREATE INDEX idx_arc_ratings_user ON arc_ratings(user_id);
CREATE INDEX idx_reading_progress_user ON user_reading_progress(user_id);
